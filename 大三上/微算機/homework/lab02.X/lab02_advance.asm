
List p=18f4520
    #include<p18f4520.inc>
	CONFIG OSC = INTIO67
	CONFIG WDT = OFF
	org 0x00 ; pc = 0x00
MOVLW 0X0B
MOVWF 0X10
MOVLW 0X05
MOVWF 0X11
MOVLW 0X40
MOVWF 0X12
MOVLW 0X07
MOVWF 0X13
MOVLW 0X0D
MOVWF 0X14
MOVLW 0X7F
MOVWF 0X15
MOVLW 0X0A
MOVWF 0X16
MOVLW 0X01
MOVWF 0X17
MOVLW 0XFE
MOVWF 0X18
MOVLW 0X08 ;??FSR1
MOVWF 0X19
MOVLW 0X08 ;??FSR0
MOVWF 0X1A
	
LFSR 0, 0x010 ;FSR0 = 010 
LFSR 1, 0X011 ;FSR1 = 011
	
control_FSR1:
    CLRF WREG
    ADDWF INDF1,0	;WREG = FSR1
    DCFSNZ 0X19	;?FSR0???????????FSR0	
	GOTO control_FSR0
    CPFSLT INDF0	;?? FSR1<FSR0????swap
	GOTO swap
    CLRF WREG		
    ADDWF POSTINC1	;FSR1++
    GOTO control_FSR1
control_FSR0:
    CLRF WREG
    ADDWF POSTINC0	;FSR0++
    DCFSNZ 0X1A
	GOTO exit
    MOVFF 0X1A,0X19 
    DECF 0X19		;[0X19] = [0X1A]-1
    GOTO sub_SFR1
sub_SFR1:
    CLRF WREG
    ADDWF POSTDEC1	;FSR1--
    DECFSZ 0X19	
	GOTO sub_SFR1
    MOVFF 0X1A,0X19	;[0X19] = [0X1A]
    GOTO control_FSR1
swap:
    CLRF WREG
    ADDWF INDF1,0		;WREG = FSR1
    MOVFF INDF0,POSTINC1	;FSR1 = FSR0 ;FSR1++
    MOVWF INDF0		;FSR0 = WREG = FSR1
    GOTO control_FSR1
exit:
    NOP
end


